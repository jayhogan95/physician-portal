<%- include("./partials/header") %>

<div class="container">
	<div class="row">
		<div class="col-md-12">
			<% if (currentUser.branchAssoc == "Health Complex-Waterbury") { %>
				<div>
					<h1 class="landing-header-hcm">Users</h1>
					<a class="btn button-style btn-md hcm-btn float-left" id="md-spacing" href="/register" role="button">Add New User</a>
					<!-- Refactor - two links in this form -->
					<form action="/admin">
						<a class="btn hcm-btn btn-md float-right ml-2 text-decoration-none" id="phone-hide" href="/admin">Clear Search</a>
					</form>
					<form class="form-group admin-search float-right" id="phone-input" action="/admin" method="GET">
						<input class="form-control col-lg-12 col-md-12 col-sm-12" type="text" name="search" placeholder="Search" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Search'">
					</form>
				</div>
				<table class="table table-striped col-md-12">
					<thead>
						<tr>
							<th scope="col">Username</th>
							<th scope="col" id="phone-hide">First Name</th>
							<th scope="col">Last Name</th>
							<th scope="col" id="phone-hide">Email</th>
							<th scope="col" id="phone-hide">Role</th>
							<th scope="col">Admin</th>
							<th scope="col"></th>
							<th scope="col"></th>
						</tr>
					</thead>
					<tbody>
						<% users.forEach(function(user) { %>
							<tr>
								<td scope="row" ><a class="hcm-no-match" href="/users/<%= user._id %>"><%= user.username %></a></td>
								<td id="phone-hide"><%= user.firstName %></td>
								<td><%= user.lastName %></td>
								<td id="phone-hide"><%= user.email %></td>
								<td id="phone-hide"><%= user.role %></td>
								<% if (user.isAdmin) { %>
									<td><input type="checkbox" checked disabled></td>
								<% } else { %>
									<td><input type="checkbox" disabled></td>
								<% } %>
								<td></td>
								<td>
									<a class="btn button-style btn-sm hcm-btn px-3" href="/users/<%= user._id %>/edit" role="button">Edit</a>
									<form id="delete-form" action="/users/<%= user._id %>?_method=DELETE" method="POST">
										<button class="btn button-style btn-sm delete-btn" id="delete-form">Delete</button>
									</form>
								</td>
							</tr>
						<% }) %>
					</tbody>
				</table>	
			<% } else if (currentUser.branchAssoc == "Cape Medical Supply Sandwich") { %>
				<div>
					<h1 class="landing-header-cape">Users</h1>
					<a class="btn button-style btn-md cape-btn float-left" id="md-spacing" href="/register" role="button">Add New User</a>
					<!-- Refactor - two links in this form -->
					<form action="/admin">
						<a class="btn cape-btn btn-md float-right ml-2 text-decoration-none" id="phone-hide" href="/admin">Clear Search</a>
					</form>
					<form class="form-group admin-search float-right" id="phone-input" action="/admin" method="GET">
						<input class="form-control col-lg-12 col-md-12 col-sm-12" type="text" name="search" placeholder="Search" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Search'">
					</form>
				</div>
				<table class="table table-striped col-md-12">
					<thead>
						<tr>
							<th scope="col">Username</th>
							<th scope="col" id="phone-hide">First Name</th>
							<th scope="col">Last Name</th>
							<th scope="col" id="phone-hide">Email</th>
							<th scope="col" id="phone-hide">Role</th>
							<th scope="col">Admin</th>
							<th scope="col"></th>
							<th scope="col"></th>
						</tr>
					</thead>
					<tbody>
						<% users.forEach(function(user) { %>
							<tr>
								<td scope="row" ><a class="cape-no-match" href="/users/<%= user._id %>"><%= user.username %></a></td>
								<td id="phone-hide"><%= user.firstName %></td>
								<td><%= user.lastName %></td>
								<td id="phone-hide"><%= user.email %></td>
								<td id="phone-hide"><%= user.role %></td>
								<% if (user.isAdmin) { %>
									<td><input type="checkbox" checked disabled></td>
								<% } else { %>
									<td><input type="checkbox" disabled></td>
								<% } %>
								<td></td>
								<td>
									<a class="btn button-style btn-sm cape-btn px-3" href="/users/<%= user._id %>/edit" role="button">Edit</a>
									<form id="delete-form" action="/users/<%= user._id %>?_method=DELETE" method="POST">
										<button class="btn button-style btn-sm delete-btn" id="delete-form">Delete</button>
									</form>
								</td>
							</tr>
						<% }) %>
					</tbody>
				</table>
			<% } else if (currentUser.branchAssoc == "America's HealthCare at Home, Inc") { %>
				<div>
					<h1 class="landing-header-ahcah">Users</h1>
					<a class="btn button-style btn-md ahcah-btn float-left" id="md-spacing" href="/register" role="button">Add New User</a>
					<!-- Refactor - two links in this form -->
					<form action="/admin">
						<a class="btn ahcah-btn btn-md float-right ml-2 text-decoration-none" id="phone-hide" href="/admin">Clear Search</a>
					</form>
					<form class="form-group admin-search float-right" id="phone-input" action="/admin" method="GET">
						<input class="form-control col-lg-12 col-md-12 col-sm-12" type="text" name="search" placeholder="Search" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Search'">
					</form>
				</div>
				<table class="table table-striped col-md-12">
					<thead>
						<tr>
							<th scope="col">Username</th>
							<th scope="col" id="phone-hide">First Name</th>
							<th scope="col">Last Name</th>
							<th scope="col" id="phone-hide">Email</th>
							<th scope="col" id="phone-hide">Role</th>
							<th scope="col">Admin</th>
							<th scope="col"></th>
							<th scope="col"></th>
						</tr>
					</thead>
					<tbody>
						<% users.forEach(function(user) { %>
							<tr>
								<td scope="row" ><a class="ahcah-no-match" href="/users/<%= user._id %>"><%= user.username %></a></td>
								<td id="phone-hide"><%= user.firstName %></td>
								<td><%= user.lastName %></td>
								<td id="phone-hide"><%= user.email %></td>
								<td id="phone-hide"><%= user.role %></td>
								<% if (user.isAdmin) { %>
									<td><input type="checkbox" checked disabled></td>
								<% } else { %>
									<td><input type="checkbox" disabled></td>
								<% } %>
								<td></td>
								<td>
									<a class="btn button-style btn-sm ahcah-btn px-3" href="/users/<%= user._id %>/edit" role="button">Edit</a>
									<form id="delete-form" action="/users/<%= user._id %>?_method=DELETE" method="POST">
										<button class="btn button-style btn-sm delete-btn" id="delete-form">Delete</button>
									</form>
								</td>
							</tr>
						<% }) %>
					</tbody>
				</table>	
			<% } else { %>
				<!-- Add all other companies here -->
				<div>
					<h1 class="landing-header-global">Users</h1>
					<a class="btn button-style btn-md global-btn float-left" id="md-spacing" href="/register" role="button">Add New User</a>
					<!-- Refactor - two links in this form -->
					<form action="/admin">
						<a class="btn global-btn btn-md float-right ml-2 text-decoration-none" id="phone-hide" href="/admin">Clear Search</a>
					</form>
					<form class="form-group admin-search float-right" id="phone-input" action="/admin" method="GET">
						<input class="form-control col-lg-12 col-md-12 col-sm-12" type="text" name="search" placeholder="Search" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Search'">
					</form>
				</div>
				<table class="table table-striped col-md-12">
					<thead>
						<tr>
							<th scope="col">Username</th>
							<th scope="col" id="phone-hide">First Name</th>
							<th scope="col">Last Name</th>
							<th scope="col" id="phone-hide">Email</th>
							<th scope="col" id="phone-hide">Role</th>
							<th scope="col">Admin</th>
							<th scope="col"></th>
							<th scope="col"></th>
						</tr>
					</thead>
					<tbody>
						<% users.forEach(function(user) { %>
							<tr>
								<td scope="row" ><a class="global-no-match" href="/users/<%= user._id %>"><%= user.username %></a></td>
								<td id="phone-hide"><%= user.firstName %></td>
								<td><%= user.lastName %></td>
								<td id="phone-hide"><%= user.email %></td>
								<td id="phone-hide"><%= user.role %></td>
								<% if (user.isAdmin) { %>
									<td><input type="checkbox" checked disabled></td>
								<% } else { %>
									<td><input type="checkbox" disabled></td>
								<% } %>
								<td></td>
								<td>
									<a class="btn button-style btn-sm global-btn px-3" href="/users/<%= user._id %>/edit" role="button">Edit</a>
									<form id="delete-form" action="/users/<%= user._id %>?_method=DELETE" method="POST">
										<button class="btn button-style btn-sm delete-btn" id="delete-form">Delete</button>
									</form>
								</td>
							</tr>
						<% }) %>
					</tbody>
				</table>	
			<% } %>
		</div>
	</div>
	
	<nav class="pagination-nav" aria-label="Pagination">
			<% if (pages && pages > 0) { %>
			<ul class="pagination justify-content-center">
				<% if (current == 1) { %>
				<li class="page-item"><a class="page-link">First</a></li>
				<% } else { %>
				<li class="page-item"><a class="page-link" href="/admin">First</a></li>
				<% } %>

				<% if (current == 1) { %>
				<li class="page-item"><a class="page-link">«</a></li>
				<% } else { %>
				<li class="page-item"><a class="page-link" href="/admin?page=<%= Number(current) - 1 %>">«</a></li>
				<% } %>

				<% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
				<% if (i !== 1) { %>
				<li class="page-item"><a class="page-link">...</a></li>
				<% } %>
				<% for (; i <= (Number(current) + 4) && i <= pages; i++) { %>
				<% if (i == current) { %>
				<li class="active"><a class="page-link"><%= i %></a></li>
				<% } else { %>
				<li class="page-item"><a class="page-link" href="/admin?page=<%= i %>"><%= i %></a></li>
				<% } %>
				<% if (i == Number(current) + 4 && i < pages) { %>
				<li class="page-item"><a class="page-link">...</a></li>
				<% } %>
				<% } %>

				<% if (current == pages) { %>
				<li class="page-item"><a class="page-link">»</a></li>
				<% } else { %>
				<li class="page-item"><a class="page-link" href="/admin?page=<%= Number(current) + 1 %>">»</a></li>
				<% } %>

				<% if (current == pages) { %>
				<li class="page-item"><a class="page-link">Last</a></li>
				<% } else { %>
				<li class="page-item"><a class="page-link" href="/admin?page=<%= pages %>">Last</a></li>
				<% } %>
			</ul>
			<% } %>
		</nav>
</div>

<%- include("./partials/footer") %>